%! TeX root: ./main.tex
\input{preamble}
\title{Effetti non lineari sulle onde di Alfvén in una dimensione}
\author{Edoardo Gabrielli}

\begin{document}
\maketitle
\section{Sistema di partenza}
Le equazioni che descrivono l'evoluzione dei modi incomprimibili ($\nabla \cdot \vv{u} = 0$) di un plasma secondo il modello MHD sono:
\begin{align}
     & \pd{\vv{B}} = \nabla \times (\vv{u} \times \vv{B}) + \eta \nabla^2 \vv{B}                                   \\
     & \rho \left[\pd{\vv{u}} + (\vv{u} \nabla)\vv{u}\right] = - \nabla p + \frac{1}{4\pi} (\nabla \times \vv{B} ) \times \vv{B}.
    \label{eq:moto}
\end{align}
In cui $\eta$ è definita in termini della conducibilità elettrica $\sigma$:
\[
    \eta = \frac{c^2}{4\pi\sigma}
\]
\section{Quatità caratteristiche e variabili adimensionali}
Ipotizziamo che nel sistema sia presente un campo magnetico esterno costante $\vv{B}_0$.\\
Rendiamo le due equazioni adimensionali tramite l'uso di quantità caratteristiche del sistema e rinominiamo tutte le quantità dimensionali con una barra (esempio di campo magnetico dimensionato: $\overline{\vv{B}}$):

\begin{itemize}
    \item $\vv{x} = \overline{\vv{x}}/\tilde{L}$ con $\tilde{L}$ lunghezza caratteristica MHD.
    \item $\vv{B} = \ov{\vv{B}}/B_0$ con $B_0$ modulo del campo magnetico esterno.
    \item $\rho = \ov{\rho}/\tilde{\rho}$ con $\tilde{\rho}$ densità costante del plasma. Si ha che vale la relazione:
          \[
              \tilde{L}^3 \simeq \lambda_{mfp}^3 \gg r_n^3 \equiv \frac{1}{\tilde{\rho }}
          \]
      \item $\vv{u} = \ov{\vv{u}}/v_A$ con $v_A$ velocità di Alfvén.
          \[v_A = \frac{B_0}{\sqrt{4\pi \tilde{\rho}}}\]
\end{itemize}
Ci sono inoltre alcune grandezze utili alle analisi successive che possono essere ricavate da quelle sopra:
\begin{itemize}
    \item $p = \ov{p}/\tilde{p}$ con $\tilde{p}$ pressione caratteristica data da $\tilde{\rho} v_A^2$.
    \item $\tau = \ov{t} /\tilde{\tau}$ con $\tilde{\tau}$ definito a partire dalle grandezze caratteristiche $\tilde{L}$ e $v_A$:
          \[\tilde{\tau} = \frac{\tilde{L}}{v_A}.\]
    \item $\tau_D = L^2 / \eta$ tempo diffusivo, definito a partire dalla equazione per $\vv{B}$ ipotizzando che il termine $\eta \nabla^2\vv{B}$ sia dominante su $\nabla \times (\vv{u} \times \vv{B})$.
    \item $R_m = \tau_D/\tilde{\tau} = v_A \tilde{L}/\eta$ Numero di Raynolds magnetico.
\end{itemize}
\subsection{Equazione per B}
Si colorano in rosso le quantità necessarie alla normalizzazione delle equazioni:
\begin{equation}
    \textcolor{red}{\frac{\tilde{\tau}}{\tilde{B}}}
    \left[\pdx{\ov{\vv{B}}}{\ov{t}}\right]
    =
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}}
    \left[ \ov{\nabla} \times (\ov{\vv{u}} \times \ov{\vv{B}}) + \eta \ov{\nabla}^2 \ov{\vv{B}} \right].
\end{equation}
Il termine di destra è banalmente adimensionale, i termini di sinistra gli analizziamo singolarmente:
\[
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}}
    \ov{\nabla} \times (\ov{\vv{u}} \times \ov{\vv{B}})
    \sim
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}}
    \frac{1}{\ov{L}} \ov{u} \ov{B}
    =
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}
    \frac{v_A}{v_A}} \frac{1}{\ov{L}} \ov{u} \ov{B}
    =
    \textcolor{red}{\frac{\tilde{L}}{\tilde{B}v_A}}\frac{1}{\ov{L}} \ov{u} \ov{B}
    =
    \frac{uB}{L}
\]
Passiamo al termine diffusivo:
\[
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}}
    \eta \ov{\nabla}^2 \ov{\vv{B}}
    \sim
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }}} \eta \frac{\ov{B}}{\ov{L}^2}
    =
    \textcolor{red}{\frac{\tilde{\tau }}{\tilde{B }} \frac{\tilde{L}^2}{\tilde{L}^2}} \eta \frac{\ov{B}}{\ov{L}^2}
    = \frac{\tau }{\tau_D } \frac{B}{L} = R_m^{-1} \frac{B}{L^2}
\]
Adesso a regolare la diffusione vi è il numero di Raynolds magnetico e l'equazione diventa:
\[
    \pd{\vv{B}} = \nabla \times (\vv{u} \times \vv{B}) + R_m^{-1} \nabla^2 \vv{B}
\]
\subsection{Equazione per u}
Analogamente a quanto fatto sopra si procede a normalizzare con la quantità:
\[
    N =  \textcolor{red}{\frac{\tilde{L}}{v_A^2 \tilde{\rho}}}
\]
Saltando i passaggi algebrici si ottiene una equazione identica alla originale ma con variabili adimensionali:
\[
    \rho \left[\pd{\vv{u}} + (\vv{u} \nabla)\vv{u}\right] = - \nabla p + (\nabla \times \vv{B} ) \times \vv{B}.
\]
\section{Semplificazione delle equazioni}
Ricordando le proprietà dei prodotti vettoriali si ha che:
\begin{align}
     & (\nabla \times \vv{B}) \times \vv{B
    } = (\vv{B}\nabla)\vv{B} - \nabla\left(\frac{B^2 }{2}\right)     \\
     & \nabla \times (\vv{u} \times \vv{B}) = (\vv{B} \nabla) \vv{u} - (\vv{u}\nabla) \vv{B}
\end{align}
Quindi si ottiene il sistema:
\begin{align}
    & \pd{\vv{B}} + (\vv{u}\nabla) \vv{B} = (\vv{B} \nabla) \vv{u} + R_m^{-1} \nabla^2 \vv{B} \label{eq:mod1}\\
    & \rho \left[\pd{\vv{u}} + (\vv{u} \nabla) \vv{u}\right] = - \nabla \Pi + (\vv{B}\nabla)\vv{B}.\label{eq:mod2}
\end{align}
In cui il termine $\nabla\Pi$ contiene il contributo sia della pressione fluida ($\nabla p$) che di quella magnetica ($\nabla (B^2/2)$).
\section{Soluzione nel caso di onda che propaga con un angolo $\theta$ rispetto al campo esterno $B_0$}
Scegliamo un plasma con densità uniforme $\rho = 1$ e prendiamo un sistema di assi cartesiano $x-y-z$ chiamato S1, scegliamo il campo magnetico esterno uniforme $\vv{B}_0$ diretto lungo l'asse $z$.
\[
    \vv{B}_0 = B_0 \hat{z}.
\]
\begin{figure}[H]
    \centering
    \input{xyz}
    \caption{Sistema di riferimento iniziale}
    \label{fig:sis_in}
\end{figure}
\noindent
Prendiamo delle perturbazioni di $\vv{u}$ e $\vv{B}$ che propagano in direzione $\vv{k}$, l'asse $y$ del sistema viene scelto in modo tale da posizionare il vettore $\vv{k}$ nel piano $x-z$ come in Figura \ref{fig:sis_in}.\\
Per comodità effettuiamo una rotazione del sistema di riferimento andando a sovrappore il versore $\hat{x}$ con l'asse determinato dal vettore $\vv{k}$. In questa rotazione l'asse $y$ rimane invariato. Chiamiamo questo nuovo sistema di riferimento S2.
\[S2: \ \hat{k}-\hat{y}-\hat{z_1} \]
\begin{figure}[H]
    \centering
    \input{kyz}
    \caption{Sistema di riferimento ruotato}
    \label{fig:sis_fin}
\end{figure}
In S2 il campo magnetico esterno si può esprimere come:
\[
    \vv{B}_0 =
    \begin{pmatrix}
        \cos\theta &
        0              &
        \sin\theta\end{pmatrix}
\]
In cui si ricorda che le equazioni sono state rese adimensionali proprio utilizzando il modulo del campo magnetico esterno.\\
Il vettore d'onda è diretto tutto lungo $\hat{k}$. Quest'ultima informazione, messa insieme a $\nabla \vv{u} = \nabla \vv{B} = 0$ permette di concludere che le componenti lungo $\hat{k}$ di $\vv{u}$ e $\vv{B}$ devono essere nulle per costruzione (si usa la notazione $\hat{k} = x$):
\begin{align*}
     & \vv{u}(x, t) = \begin{pmatrix}
                          0, & u_{y}(x, t), & u_{z}(x, t)
                      \end{pmatrix}                                   \\
     & \vv{B}(x, t) = \begin{pmatrix}
                          \cos(\theta), & b_{y}(x, t), & \sin(\theta) + b_{z}(x, t)
                      \end{pmatrix}
\end{align*}
Adesso si sostituisce tutto all'interno delle equazioni e si estrae la componente $y$, si può osservare che i prodotto "non lineari" delle quantità di interesse si annullano in tale direzione, ad esempio si ha che:
\begin{align*}
     & \left[\vv{u}\nabla\right]\vv{B} =
    \left[\begin{pmatrix}
                  0, & u_y(x, t), & u_z(x, t)
              \end{pmatrix}
        \begin{pmatrix}
            \partial_x \\ \partial_y \\ \partial_z
        \end{pmatrix}\right]
    \begin{pmatrix}
        \cos(\theta), & b_{y}(x, t), & \sin(\theta) + b_{z}(x, t)
    \end{pmatrix} = \vv{0} \\
     & \left[\vv{B}\nabla\right]\vv{u} =
    \left[\begin{pmatrix}
                 \cos(\theta), & b_{y}, & \sin(\theta) + b_{z}
              \end{pmatrix}
        \begin{pmatrix}
            \partial_x \\ \partial_y \\ \partial_z
        \end{pmatrix}\right]\begin{pmatrix}
                            0, & u_{y}(x, t), & u_{z}(x, t)
                        \end{pmatrix}
    = \begin{pmatrix}
          0                                       \\
          \cos(\theta) \partial_x   u_y(x, t) \\
          \cos(\theta) \partial_x   u_z(x, t)
      \end{pmatrix}
\end{align*}
inoltre i termini di pressione agiscono solo lungo la direzione di propagazione $\hat{k}$, ortogonale a $y$. Si ha quindi che la componente $y$ delle quantità di interesse risulta completamente disaccoppiata dalle altre:
\begin{align}
     & \pd{b_{y}}
    =
    \cos\theta \frac{\partial u_{y}}{\partial x}
    + R_m^{-1} \frac{\partial^2 b_{y}}{\partial x^2}   \label{eq:by}    \\
     & \pd{u_{y}} = \cos\theta \frac{\partial b_y}{\partial x}
\end{align}
Tali equazioni descrivono completamente l'evoluzione temporale lungo l'asse $y$ e possono essere integrate numericamente con i parametri fisici iniziali: $\theta$, $R_m$. 
%Notiamo che per ogni valore di $\theta$ il vincolo di incomprimibilità esclude dalle equazioni per $b_y, u_y$ la presenza di qualsiasi termine non lineare.\\
La soluzione è data da onde stazionarie la cui ampiezza diminuisce nel tempo per via del termine diffusivo presente nell'equazione \ref{eq:by}.

\begin{comment}
Si può utilizzare la trasformata di Fourier per ottenere la relazione di dispersione:
\begin{align*}
     & -i\omega b_y = i B_0 k_{\parallel} u_{1y} - \eta k^2 b_{y}    \\
     & -i \rho_0 \omega u_{1y} = \frac{ik_{\parallel} B_0}{4\pi} b_y
\end{align*}
Dove $k_{\parallel}$ è la componente del vettore d'onda parallela al campo magnetico esterno $\vv{B}_0$.\\
Sostituendo $u_{1y}$ nella prima si ricava la relazione di dispersione:
\[
    \omega^2 = v_A^2 k_{\parallel}^2 - i \eta k^2
\]
con $k^2 = k_{\perp}^2 + k_{\|}^2$ e $v_A$ velocità di Alfvén:
\[
    v_A = \sqrt{\frac{B_0^2}{4\pi \rho_0}}
\]
Il termine complesso nella relazione di dispersione indica un decadimento dell'onda durante la propagazione, come atteso avendo aggiunto il termine resistivo.
\end{comment}

\section{Variabili di Elsasser e modello 1D}
Torniamo al modello descritto dalle equazioni \ref{eq:mod1} e \ref{eq:mod2}, separiamo il campo magnetico in una parte esterna costante ed uniforme $\vv{B}_0$ e le sue perturbazioni $\vv{b}$ (non necessariamente di piccola ampiezza). Esprimiamo quindi il campo (ricordando che le variabili in gioco sono adesso adimensionali): 
\[
    \vv{B} = \frac{\vv{B}_0}{\left|\vv{B}_0\right|} + \frac{\vv{b'}}{\left|\vv{B}_0\right|} \equiv \hat{B}_0 + \vv{b}
\]
Il termine $\hat{B}_0$ indica il versore del campo magnetico esterno uniforme, tale campo entra nelle equazioni precedenti soltanto nei termini $\hat{B}_0 \nabla$, quindi semplificheremo l'equazione indicando questo termine come $\nabla_{B_0}$ che indica la componente di $\nabla$ lungo il campo esterno.\\
Le equazioni della dinamica possono essere espresse in termini di $\vv{b}$ ed $\vv{u}$, ponendo anche $\rho = 1$:
\begin{align}
     & \pd{\vv{b}}  + (\vv{u}\nabla) \vv{b} - \nabla_{B_0} \vv{u} - (\vv{b} \nabla) \vv{u} = R_m^{-1} \nabla^2 \vv{b} \label{eq:init_elsa1}\\
     & \pd{\vv{u}}  + (\vv{u}\nabla) \vv{u} - \nabla_{B_0} \vv{b} - (\vv{b} \nabla) \vv{b} = -\nabla \Pi. \label{eq:init_elsa2}
\end{align}
Sommmiamo e sottraiamo le due equazioni per riscriverle in termini di variabili di Elsasser:
\begin{align*}
    &\vv{z}^+ = \vv{u} + \vv{b} \\
    &\vv{z}^- = \vv{u} - \vv{b} 
\end{align*}
Notiamo che il termine resistivo si esprime come:
\[
    \nabla^2 \vv{b} = \nabla^2 (\vv{z}^+ - \vv{z}^-)
\]
Le equazioni possono essere espresse nella forma compatta:
\[
    \pd{\vv{z}^{\pm}} \mp \nabla_{B_0} \vv{z}^{\pm} + \vv{z}^{\mp} \nabla \vv{z}^{\pm} = -\nabla \Pi + \frac{1}{2R_m} \nabla^2 (\vv{z}^{\pm} - \vv{z}^{\mp})
\]
Si studia adesso il sistema ipotizzando di poter scrivere le equazioni di cui sopra nel caso 1D incomprimibile senza la perdita dei termini non lineari, si sceglie per semplicità un'onda che propaga nella direzione stessa del campo magnetico esterno $B_0$ e la pressione totale $\Pi$ costante in $x$.\\
Nella geometria 1D scelta i termini non-lineari dovrebbero essere nulli poiché $\nabla \cdot \vv{u} = \nabla \cdot \vv{b} = 0$ ( ed in una dimensione significa che $z^{\mp} \pdx{z^{\pm}}{x} = 0$), tuttavia in questa analisi vengono mantenuti con lo scopo di comprendere concettualmente la loro azione sulla propagazione delle soluzioni. \\
Notiamo inoltre che, in una dimensione,  assumere l'incomprimibilità porta a soluzioni banali: la richiesta di $\pdx{z}{x} = 0$ $\forall t$ implica che la soluzione sia costante in $x$ per ogni tempo.\\
Le equazioni 1D in gioco sono adesso:
\begin{align}
    &\pd{z^+} - \pdx{z^+}{x} + z^- \pdx{z^+}{x} = \frac{1}{2R_m} \frac{\partial^2}{\partial x^2}(z^+ - z^-) \label{eq:Elsa1}\\
    &\pd{z^-} + \pdx{z^-}{x} + z^+ \pdx{z^-}{x} = \frac{1}{2R_m} \frac{\partial^2}{\partial x^2}(z^- - z^+) \label{eq:Elsa2}
\end{align}
Queste equazioni rappresentano due soluzioni che evolvono nella direzione opposta per via del termine di advezione $\mp \partial_x z^{\pm}$, la velocità di tale evoluzione è proprio quella di Alfvén (unitaria nelle variabili adimensionali).\\
La sovapposizione delle soluzioni, mosse dall'advezione, da origine a fenomeni non lineari. Tali fenomeni possono essere modulati dal termine di destra dissipativo scegliendo opportunamente il numero di Raynolds magnetico. \\
Il termine di destra nelle equazioni non ha esattamente la struttura di un usuale termine diffusivo, infatti il laplaciano agisce sulla differenza delle variabili di Elsasser per entrambe le equazioni. 
\subsection{Soluzione numerica in termini di variabili di Elsasser}
Si studia numericamente l'evoluzione di alcune condizioni iniziali secondo le equazioni \ref{eq:Elsa1} e \ref{eq:Elsa2}, si prende una griglia $x$ uniforme nell'intervallo $\left[0, L\right]$ e si utilizzano delle condizioni al contorno non riflettenti, definite nella appendice \ref{appendix:nonrefl}. 
Le condizioni iniziali scelte sono le seguenti:
\begin{align*}
    &z^{+} = A_1\exp\left(-\frac{(x-\mu^+)^2}{\sigma^2}\right) \sin\left(k \frac{\pi}{\sigma}(x-\mu^+)\right)\\
    &z^{-} = A_2\exp\left(-\frac{(x-\mu^-)^2}{\sigma^2}\right)
\end{align*}
Il metodo di integrazione scelto è il Runge Kutta di ordine 4 (in t) mentre per le derivate si sono utilizzate le differenze finite compatte di ordine 4 (in x). Si è utilizzato un filtro del tipo "spectral-like resolution" di ordine 6 proposto da Lele nel suo articolo.\\
In Figura \ref{fig:zpm_full} si mostra l'andamento delle soluzioni con i seguenti parametri:
\begin{itemize}
    \item $L = 10$, $R_m = 10^3$.
    \item $dt = 2 \cdot 10^{-4}$, $dx = 10^{-2}$, step temporali = $3\cdot 10^4$.
    \item $A_1 = 1.5$, $A_2 = 1.2$, $\sigma$ = L/10, $\mu^- = 4L/5$, $\mu^+ = L/5$, $k$ = 1.
\end{itemize}
\begin{figure}[h!]
    \centering
    \includegraphics[width=\textwidth]{../../figure/zpm_evo_full.png}
    \caption{\scriptsize Andamento di $z^{\pm}$ al variare del tempo fisico, si nota la non linearità delle soluzioni quando si sovrappongono nello spazio $(x, t)$. In tratteggiato invece si osserva l'andamento della soluzione quando si rimuovono i termini non lineari dalle equazioni. \href{https://datapane.com/reports/0keDG07/copy-simulazione-z/}{Link} alla simulazione completa}
    \label{fig:zpm_full}
\end{figure}
Notiamo dalle curve tratteggiate in Figura \ref{fig:zpm_full} che in assenza di termini non lineari le due soluzioni non interagiscono e semplicemente propagano con velocità caratteristica unitaria.
\input{appendix}
\end{document}
